<script type="text/template" id="chat_create-template">
	<div class="create_chat_header">
		<a id="back_to_main_chat" >
			<svg width="2.25em" height="2.25em" viewBox="0 0 16 16" class="bi bi-x-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
	  		</svg>
		</a>
		<h2>Create a channel</h2>

	</div>

	<div class="create_chat_body">
		<form>
			<div class="form-group">
				<label for="ChannelName">Channel Name</label>
				<input type="text" class="form-control" id="inputChannelName">
			</div>

			<div class="form-group">
				<label for="inputStatus">Channel status</label>
				<select class="form-control form-control-md" id="selectScope">
					<option>protected</option>
					<option>private</option>
					<option>public</option>
				</select>
			</div>

			<div class="form-group">
				<label for="inputPassword">Password</label>
				<input type="password" id="inputCreatePassword" class="form-control" aria-describedby="passwordHelpBlock">
				<small id="passwordHelpBlock" class="form-text text-muted">
					Your password must be 8-20 characters long, used only for private channel
				</small>
			</div>

			<div class="form-group">
				<button type="button" onclick="ft_create_group()" class="btn btn-primary mb-2 btn-dark">Create</button>
			</div>
		</form>
	</div>

	<div class="create_chat_footer">
	</div>
	<script type="text/javascript">
		function ft_create_group()
		{
			var channel_name = $("#inputChannelName").val();
			console.log("channel_name = " + channel_name);
			var channel_scope = $("#selectScope").val();
			console.log(channel_scope);
			var pwd = $("#inputCreatePassword").val();
			console.log(pwd);
			if (channel_scope == "protected" && pwd.length == 0)
			{
				alert("A password is needed for protected scope")
				return;
			}
			var form_data = new FormData();
			form_data.append("name", channel_name);
			form_data.append("scope", channel_scope + "-group");
			if (channel_scope == "protected")
				form_data.append("password", pwd);
			form_data.append("owner_id", <%== current_user.id %>);
			$.ajax({
				url: "/channels",
				data: form_data,
				processData: false,
				contentType: false,
				type: 'POST',
				success: function(){
					console.log("sent !");
					alert("group created !");
					$("#inputChannelName").val('');
					$("#inputCreatePassword").val('');
				}
			})
			console.log("create group !");
		}
	</script>
</script>